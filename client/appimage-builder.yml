version: 1

script:
  # 1. Очистка предыдущей сборки
  - rm -rf AppDir || true
  # 2. Создаем AppDir и копируем бинарь
  - mkdir -p AppDir
  - cp build/linux/x64/release/bundle/* AppDir/  # Копируем содержимое bundle в корень AppDir
  - cp appimage_builder/client.desktop AppDir/
  - cp appimage_builder/client.png AppDir/

AppDir:
  path: ./AppDir

  app_info:
    id: com.yourcompany.todo
    name: ToDo
    icon: client
    version: 1.0.0
    exec: client  # Исполняемый файл находится в корне AppDir
    exec_args: $@

  apt:
    arch: amd64
    sources:
      - sourceline: "deb [trusted=yes] http://archive.ubuntu.com/ubuntu/ focal main restricted universe multiverse"
    include:
      - libgtk-3-0
      - libsecret-1-0
      - libnotify4
      - libayatana-appindicator3-1

  files:
    exclude:
      - usr/share/man
      - usr/share/doc/*/README.*
      - usr/share/doc/*/changelog.*

AppImage:
  arch: x86_64
  update-information: guess
  sign-key: None